<%- include('partials/static-header', {
    pageTitle: typeof t !== 'undefined' ? t('contact.title') : 'è”ç³»æˆ‘ä»¬ - Ice Breaker Games',
    metaDescription: typeof t !== 'undefined' ? t('contact.subtitle') : 'è”ç³»æˆ‘ä»¬ - Ice Breaker Gamesï¼Œæ¬¢è¿éšæ—¶ä¸æˆ‘ä»¬å–å¾—è”ç³»ï¼Œå®˜æ–¹é‚®ç®±ï¼šhcf@foxmail.com',
    metaKeywords: 'ice breaker games, è”ç³»æˆ‘ä»¬, è”ç³»æ–¹å¼, å®˜æ–¹é‚®ç®±, æ·±åœ³é¾™å',
    canonicalUrl: typeof localeUrl !== 'undefined' ? localeUrl('/contact') : 'https://www.icebreakgame.com/contact',
    currentPage: 'contact'
}) %>

<main>
    <div class="container">
        <div class="page-header">
            <h1 class="page-title"><%= typeof t !== 'undefined' ? t('contact.title').replace(' - Ice Breaker Games', '') : 'è”ç³»æˆ‘ä»¬' %></h1>
            <p class="page-subtitle"><%= typeof t !== 'undefined' ? t('contact.subtitle') : 'æ¬¢è¿éšæ—¶ä¸æˆ‘ä»¬å–å¾—è”ç³»' %></p>
        </div>

        <div class="contact-content">
            <div class="contact-info">
                <h2 class="section-title"><%= typeof t !== 'undefined' ? t('contact.contactInfo') : 'è”ç³»æ–¹å¼' %></h2>
                
                <div class="contact-item">
                    <div class="contact-icon">ğŸ“§</div>
                    <div class="contact-details">
                        <h3><%= typeof t !== 'undefined' ? t('contact.officialEmail') : 'å®˜æ–¹é‚®ç®±' %></h3>
                        <p>hcf@foxmail.com</p>
                        <a href="mailto:hcf@foxmail.com"><%= typeof t !== 'undefined' ? t('contact.sendEmail') : 'å‘é€é‚®ä»¶' %></a>
                    </div>
                </div>

                <div class="contact-item">
                    <div class="contact-icon">ğŸ“</div>
                    <div class="contact-details">
                        <h3><%= typeof t !== 'undefined' ? t('contact.companyAddress') : 'å…¬å¸åœ°å€' %></h3>
                        <p><%= typeof t !== 'undefined' ? t('contact.addressDetail') : 'æ·±åœ³å¸‚é¾™ååŒºé¾™åå¤§é“130å·' %></p>
                        <a href="#" onclick="showMap()"><%= typeof t !== 'undefined' ? t('contact.viewMap') : 'æŸ¥çœ‹åœ°å›¾' %></a>
                    </div>
                </div>

                <div class="response-time">
                    <h3>â° <%= typeof t !== 'undefined' ? t('contact.responseTime') : 'å“åº”æ—¶é—´' %></h3>
                    <p><%= typeof t !== 'undefined' ? t('contact.responseTimeDesc') : 'æˆ‘ä»¬ä¼šåœ¨æ”¶åˆ°æ‚¨çš„é‚®ä»¶å1-3ä¸ªå·¥ä½œæ—¥å†…å›å¤' %></p>
                </div>

                <div class="office-hours">
                    <h3>ğŸ•’ <%= typeof t !== 'undefined' ? t('contact.workingHours') : 'å·¥ä½œæ—¶é—´' %></h3>
                    <ul class="hours-list">
                        <li>
                            <span class="day"><%= typeof t !== 'undefined' ? t('contact.mondayFriday') : 'å‘¨ä¸€è‡³å‘¨äº”' %></span>
                            <span class="time"><%= typeof t !== 'undefined' ? t('contact.mondayFridayTime') : '09:00 - 18:00' %></span>
                        </li>
                        <li>
                            <span class="day"><%= typeof t !== 'undefined' ? t('contact.saturday') : 'å‘¨å…­' %></span>
                            <span class="time"><%= typeof t !== 'undefined' ? t('contact.saturdayTime') : '10:00 - 16:00' %></span>
                        </li>
                        <li>
                            <span class="day"><%= typeof t !== 'undefined' ? t('contact.sunday') : 'å‘¨æ—¥' %></span>
                            <span class="time"><%= typeof t !== 'undefined' ? t('contact.sunday') : 'ä¼‘æ¯' %></span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="contact-form">
                <h2 class="section-title"><%= typeof t !== 'undefined' ? t('contact.sendMessage') : 'å‘é€æ¶ˆæ¯' %></h2>
                <form id="contactForm">
                    <div class="form-group">
                        <label for="name"><%= typeof t !== 'undefined' ? t('contact.nameRequired') : 'å§“å *' %></label>
                        <input type="text" id="name" name="name" required>
                    </div>

                    <div class="form-group">
                        <label for="email"><%= typeof t !== 'undefined' ? t('contact.emailRequired') : 'é‚®ç®± *' %></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="subject"><%= typeof t !== 'undefined' ? t('contact.subject') : 'ä¸»é¢˜' %></label>
                        <select id="subject" name="subject">
                            <option value="general"><%= typeof t !== 'undefined' ? t('contact.subjects.general') : 'ä¸€èˆ¬å’¨è¯¢' %></option>
                            <option value="technical"><%= typeof t !== 'undefined' ? t('contact.subjects.technical') : 'æŠ€æœ¯æ”¯æŒ' %></option>
                            <option value="business"><%= typeof t !== 'undefined' ? t('contact.subjects.business') : 'å•†åŠ¡åˆä½œ' %></option>
                            <option value="feedback"><%= typeof t !== 'undefined' ? t('contact.subjects.feedback') : 'æ„è§åé¦ˆ' %></option>
                            <option value="other"><%= typeof t !== 'undefined' ? t('contact.subjects.other') : 'å…¶ä»–' %></option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="message"><%= typeof t !== 'undefined' ? t('contact.messageRequired') : 'æ¶ˆæ¯å†…å®¹ *' %></label>
                        <textarea id="message" name="message" placeholder="<%= typeof t !== 'undefined' ? t('contact.messagePlaceholder') : 'è¯·è¯¦ç»†æè¿°æ‚¨çš„é—®é¢˜æˆ–éœ€æ±‚...' %>" required></textarea>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn"><%= typeof t !== 'undefined' ? t('contact.sendMessage') : 'å‘é€æ¶ˆæ¯' %></button>
                </form>
                <div id="formMessage" class="form-message" style="display: none;"></div>
            </div>
        </div>

        <div class="map-container">
            <h2 class="section-title"><%= typeof t !== 'undefined' ? t('contact.companyLocation') : 'å…¬å¸ä½ç½®' %></h2>
            <div class="map-placeholder" id="mapPlaceholder">
                ğŸ—ºï¸ <%= typeof t !== 'undefined' ? t('contact.mapAddress') : 'æ·±åœ³å¸‚é¾™ååŒºé¾™åå¤§é“130å·' %>
                <br>
                <small><%= typeof t !== 'undefined' ? t('contact.mapPlaceholder') : 'ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†åœ°å›¾' %></small>
            </div>
        </div>

        <div class="response-time">
            <h3>ğŸ“‹ <%= typeof t !== 'undefined' ? t('contact.emailInstructions') : 'é‚®ä»¶è¯´æ˜' %></h3>
            <p><%= typeof t !== 'undefined' ? t('contact.emailInstructionsDesc') : 'æ¶‰åŠç‰ˆæƒã€ä¾µæƒã€åˆä½œä¸å•†åŠ¡æ²Ÿé€šï¼Œè¯·å°½é‡åœ¨é‚®ä»¶ä¸­è¯´æ˜æ‚¨çš„éœ€æ±‚ä¸èƒŒæ™¯ä¿¡æ¯ï¼Œä»¥ä¾¿æˆ‘ä»¬é«˜æ•ˆå¤„ç†ã€‚' %></p>
        </div>
    </div>
</main>

<%- include('partials/static-footer') %>

<script>
    // è¡¨å•æäº¤å¤„ç†
    document.getElementById('contactForm').addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const data = Object.fromEntries(formData);
        const submitBtn = document.getElementById('submitBtn');
        const formMessage = document.getElementById('formMessage');
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        submitBtn.disabled = true;
        submitBtn.textContent = '<%= typeof t !== "undefined" && locale === "zh-CN" ? "å‘é€ä¸­..." : "Sending..." %>';
        
        // å‘é€ AJAX è¯·æ±‚
        fetch('/api/contact', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                formMessage.style.display = 'block';
                formMessage.className = 'form-message success';
                formMessage.innerHTML = '<%= typeof t !== "undefined" && locale === "zh-CN" ? "âœ“ æ¶ˆæ¯å·²å‘é€æˆåŠŸï¼æˆ‘ä»¬ä¼šå°½å¿«å›å¤æ‚¨ã€‚" : "âœ“ Message sent successfully! We will reply as soon as possible." %>';
                
                // é‡ç½®è¡¨å•
                document.getElementById('contactForm').reset();
            } else {
                // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                formMessage.style.display = 'block';
                formMessage.className = 'form-message error';
                formMessage.innerHTML = result.message || '<%= typeof t !== "undefined" && locale === "zh-CN" ? "å‘é€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚" : "Failed to send. Please try again later." %>';
            }
        })
        .catch(error => {
            console.error('Error:', error);
            formMessage.style.display = 'block';
            formMessage.className = 'form-message error';
            formMessage.innerHTML = '<%= typeof t !== "undefined" && locale === "zh-CN" ? "å‘é€å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚" : "Failed to send. Please try again later." %>';
        })
        .finally(() => {
            // æ¢å¤æŒ‰é’®çŠ¶æ€
            submitBtn.disabled = false;
            submitBtn.textContent = '<%= typeof t !== "undefined" && locale === "zh-CN" ? "å‘é€æ¶ˆæ¯" : "Send Message" %>';
            
            // 5ç§’åéšè—æ¶ˆæ¯
            setTimeout(() => {
                formMessage.style.display = 'none';
            }, 5000);
        });
    });

    // æ˜¾ç¤ºåœ°å›¾
    function showMap() {
        const mapPlaceholder = document.getElementById('mapPlaceholder');
        mapPlaceholder.innerHTML = `
            <div style="text-align: center;">
                <h3><%= typeof t !== 'undefined' ? t('contact.mapAddress') : 'æ·±åœ³å¸‚é¾™ååŒºé¾™åå¤§é“130å·' %></h3>
                <p><%= typeof t !== 'undefined' ? t('contact.mapNearby') : 'é™„è¿‘åœ°æ ‡ï¼šé¾™åæ–‡åŒ–å¹¿åœºã€é¾™ååŒºæ”¿åºœ' %></p>
                <p><%= typeof t !== 'undefined' ? t('contact.mapTransport') : 'äº¤é€šï¼šåœ°é“4å·çº¿é¾™åç«™Aå‡ºå£æ­¥è¡Œ5åˆ†é’Ÿ' %></p>
                <br>
                <a href="https://map.baidu.com/search/æ·±åœ³å¸‚é¾™ååŒºé¾™åå¤§é“130å·" target="_blank" style="color: #667eea; text-decoration: none; font-weight: bold;">
                    ğŸ—ºï¸ <%= typeof t !== 'undefined' ? t('contact.mapViewOnBaidu') : 'åœ¨ç™¾åº¦åœ°å›¾ä¸­æŸ¥çœ‹' %>
                </a>
            </div>
        `;
    }

    // ç‚¹å‡»åœ°å›¾å ä½ç¬¦æ˜¾ç¤ºåœ°å›¾
    document.getElementById('mapPlaceholder').addEventListener('click', showMap);
</script>
